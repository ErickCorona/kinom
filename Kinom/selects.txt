//Nombre de peliculas de un dia
SELECT peliculas.nom_pel  FROM peliculas,ventas,funciones WHERE ventas.id_fun = funciones.id_fun AND funciones.id_pel = peliculas.id_pel AND date(funciones.hro_fun) = date('now');

SELECT peliculas.nom_pel,ventas.id_ven FROM ventas,peliculas,funciones WHERE ventas.id_fun=funciones.id_fun AND funciones.id_pel IN (SELECT DISTINCT peliculas.id_pel FROM peliculas,funciones,ventas WHERE ventas.id_fun=funciones.id_fun AND peliculas.id_pel=funciones.id_pel AND date(funciones.hro_fun)=date('now')) AND date(funciones.hro_fun)=date('now')

//Numero de ventas por nombre
SELECT COUNT(ventas.id_ven) FROM ventas,peliculas,funciones WHERE peliculas.nom_pel=nombre AND peliculas.id_pel=funciones.id_pel AND funciones.id_fun=ventas.id_fun

SELECT DISTINCT
peliculas.id_pel,
(SELECT COUNT(ventas.id_ven) FROM ventas,funciones WHERE ventas.id_fun=funciones.id_fun AND funciones.id_pel=peliculas.id_pel AND date(funciones.hro_fun)=date('now','localtime'))
FROM
peliculas,funciones,ventas
WHERE
ventas.id_fun=funciones.id_fun
AND peliculas.id_pel=funciones.id_pel
AND date(funciones.hro_fun)=date('now','localtime')

////////////////////VISTA:

SELECT DISTINCT
date('now','localtime','+'||numeros.num||' day') as Fecha,
peliculas.nom_pel as Película,

(SELECT COUNT(ventas.id_ven) FROM ventas,funciones WHERE ventas.id_fun=funciones.id_fun AND funciones.id_pel=peliculas.id_pel AND date(funciones.hro_fun)=date('now','localtime','+'||numeros.num||' day'))
as Boletos,

(SELECT COUNT(ventas.id_ven) FROM ventas,funciones WHERE ventas.id_fun=funciones.id_fun AND funciones.id_pel=peliculas.id_pel AND date(funciones.hro_fun)=date('now','localtime','+'||numeros.num||' day'))
/
(case when precios.dosx1_pre=strftime('%w',date('now','localtime','+'||numeros.num||' day'))+1 then 2 else 1 end)
*
precios.base_pre
as Total

FROM
peliculas,funciones,ventas,numeros,precios
WHERE
ventas.id_fun=funciones.id_fun
AND peliculas.id_pel=funciones.id_pel
AND date(funciones.hro_fun)=date('now','localtime','+'||numeros.num||' day')













,
CASE
		strftime('%w','now','localtime','-'||(7+7*numeros.num)||' day','weekday 4')
		WHEN '0' THEN 'Domingo '
		WHEN '1' THEN 'Lunes '
		WHEN '2' THEN 'Martes '
		WHEN '3' THEN 'Miércoles '
		WHEN '4' THEN 'Jueves '
		WHEN '5' THEN 'Viernes '
		WHEN '6' THEN 'Sábado '
	END || strftime('%d-%m-%Y','now','localtime','-'||(7+7*numeros.num)||' day','weekday 4')